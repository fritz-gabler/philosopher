###############################################################################
###############################################################################

NAME = philo

###############################################################################
###############################################################################

CC			:=			cc
HEADERS 	:=			-I./include
CFLAGS		?=			-Wall -Werror -Wextra

###############################################################################
###############################################################################

VPATH		:=			src/main src/input_check
SRC_INPUT	:=			input_check.c

###############################################################################
###############################################################################

OBJ_DIR		:=			./_obj
OBJ_SERVER	:=			$(addprefix $(OBJ_DIR)/, $(SRC_SERVER:%.c=%.o))

###############################################################################
###############################################################################

all: $(LIBS_NAME) $(SERVER) $(CLIENT)

$(CLIENT): $(OBJ_CLIENT)
	@$(CC) $(OBJ_CLIENT) $(LIBS_NAME) -o $(CLIENT)
	@printf "$(_SUCCESS) client ready.\n"

$(OBJ_DIR)/%.o: %.c
	@mkdir -p _obj
	@$(CC) $(CFLAGS) -c $< $(HEADERS) -o $@

###############################################################################
###############################################################################

clean:
	@printf $(UP)$(CUT)
	@if [ -d "${OBJ_DIR}" ]; then \
		echo $(RED)Cleaning"  "[$(OBJ_DIR)]...$(RESET); \
		rm -rf ${OBJ_DIR}; \
		echo $(GREEN)Cleaned!$(RESET); \
	fi

fclean: clean
	@echo $(RED)Cleaning executables...
	@printf $(UP)$(CUT)
	@if [ -f client ] && [ -f server ]; then \
		echo $(RED)Cleaning"  "[$(SERVER) $(CLIENT)]...$(RESET); \
		rm -f server client; \
		echo $(GREEN)Cleaned!$(RESET); \
	fi

re: fclean all


###############################################################################
###############################################################################

YELLOW := "\033[33m"
RED := "\033[31m"
GREEN := "\033[32m"
RESET := "\033[0m" 
G		=	\e[38;5;118m
YE		=	\e[38;5;226m
RE		=	\e[0m
UP := "\033[A"
CUT := "\033[K"
_SUCCESS	=	[$(G)SUCCESS$(RE)]
_INFO		=	[$(YE)INFO$(RE)]
